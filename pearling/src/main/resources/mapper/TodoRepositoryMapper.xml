<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pearling.web.repository.TodoRepository">
   <select id="findAll" resultType="Todo">
		select *
		from to_do
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="query != null">
				content like '%${query}%'
			</if>			
		</trim>
	</select>
		<select id="findByUserId" resultType="Todo">
		select * 
		from to_do
		WHERE member_id = #{memberId};
	</select>
	<select id="findByDate" resultType="Todo">
		SELECT *
		FROM to_do
		WHERE member_id = #{memberId} AND date = '${date.toString()}'
		ORDER BY CASE WHEN statement = 'Y' THEN 0 ELSE 1 END;
	</select>
	<update id="update" >
	update to_do
	<set> 
		<if test="date != null">date = #{date},</if>
		<if test="start_time != null">regdate = #{regdate},</if>
		<if test="end_date != null">statement = #{statement},</if>
		<if test="member_id != null">member_id = #{memberId},</if>
		<if test="background_color != null">content = #{content}</if>
	</set>
	where id = #{id};
	</update>
	<insert id="save">
		insert into 
		to_do(date, statement, member_id, content)
		VALUES(#{date}, #{statement}, #{memberId}, #{content})
	</insert>



</mapper>